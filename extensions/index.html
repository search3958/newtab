<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>拡張機能管理</title>

  <link rel="stylesheet" href="./style.css">

  <script type="text/javascript" src="//typesquare.com/3/tsst/script/ja/typesquare.js?67afe5719990420aa8d92d04ac1e02e5" charset="utf-8"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@100..900&family=Noto+Sans+JP:wght@100..900&family=Unbounded:wght@200..900&display=swap" rel="stylesheet">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6151036058675874"
     crossorigin="anonymous"></script>
  <script type="importmap">
    {
      "imports": {
        "@material/web/": "https://esm.run/@material/web/"
      }
    }
  </script>
  <script type="module">
    import '@material/web/all.js';
    import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
  </script>
</head>
<body>
    <div id="animateButton" style="display:flex;margin:40px 10px;">
      <a href="https://search3958.github.io/newtab/" >
     <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#000000"><path d="M647.44-93.85 261.28-480l386.16-386.15 49.33 50L360.61-480l336.16 336.15-49.33 50Z"/></svg>
       
     </a>
     <div class="h2">Extensions</div>
       </div>

       <div class="h3">デザイン拡張</div>
       <div class="container smooth">
        <div class="card">
          <img class="card-img" src="./img/design/superglass.png">
          <div class="card-title">Ultra Glass</div>
          <div class="card-text">もっと透明感のあるLiquid Glass</div>
          <button id="setNewtab" onclick="
            document.getElementById('cssBox').value = ':root { --textboxbg: #fff0; } .search-container,.bar{backdrop-filter: blur(0px);}canvas{filter:brightness(1)!important;}';
            document.getElementById('jsBox').value = '';
            document.getElementById('addExt').click();
          ">拡張機能を追加<md-ripple></md-ripple></button>
        </div>

        <div class="card">
          <img class="card-img" src="./img/design/win11.png">
          <div class="card-title">Windows11</div>
          <div class="card-text">v3.6が拡張機能として生き返ったのかもしれない。</div>
          <button id="setNewtab" onclick="
            document.getElementById('cssBox').value = ':root{--textboxbg:#fff8!important}canvas{display:none}.search-container{border-radius:12px!important;box-shadow:0 0 14px 0 #00000011,0 10px 20px 0 #00000011!important;backdrop-filter:blur(16px)!important;padding:0px!important;transform:translate(-50%,calc(-50px + 4px))!important}#searchButton{background:#0166c0!important;mix-blend-mode:unset!important;padding:7px 19px!important;border-radius:5px!important;box-shadow:0 2px 4px 0 #0001!important}.bar{border-radius:12px!important;box-shadow:0 0 14px 0 #00000011,0 10px 20px 0 #00000011!important;backdrop-filter:blur(16px)!important}#aisearch,#setting{border-radius:5px!important}.pill{border-radius:10px!important;box-shadow:0 0 14px 0 #00000011,0 10px 20px 0 #00000011!important}.settingbtn{padding:0 16px!important;border-radius:6px!important;background:#f9f9f9!important;height:40px!important;box-shadow:0 2px 4px 0 #0001!important}input#bgUrlInput{font-size:16px!important;padding:8px 13px!important;border-radius:6px!important;width:374px!important}.bar.show{padding-bottom:334px!important}.history,button.ai-engine-btn{border-radius:10px!important;box-shadow:0 0 14px 0 #00000011,0 10px 20px 0 #00000011!important}.pillicon{border-radius:5px!important}.bg.active{background:#ffffff57!important;backdrop-filter:blur(48px)!important}@media (prefers-color-scheme:dark){:root{--textboxbg:#0008!important}#searchButton{background:#4cc1fe!important}.settingbtn{background:#111!important}.bg.active{background:#00000057!important}}';
            document.getElementById('jsBox').value = '';
            document.getElementById('addExt').click();
          ">拡張機能を追加<md-ripple></md-ripple></button>
        </div>

        <div class="card">
          <img class="card-img" src="./img/design/win10.png">
          <div class="card-title">Windowa10</div>
          <div class="card-text">いい感じにWindows10感出てる。ほんまに</div>
          <button id="setNewtab" onclick="
            document.getElementById('cssBox').value = ':root{--textboxbg:#fffa!important}canvas{display:none}.search-container{border-radius:0px!important;box-shadow:0 0 14px 0 #00000011,0 10px 20px 0 #00000011!important;backdrop-filter:blur(16px)!important;padding:0px!important;transform:translate(-50%,calc(-50px + 4px))!important}#searchButton{background:#fff3!important;mix-blend-mode:unset!important;padding:18px 19px!important;border-radius:0px!important;box-shadow:0 2px 4px 0 #0001!important;transform:translate(calc(-50% + 11px),-46px)!important}svg{fill:#000!important}.bar{border-radius:0px!important;box-shadow:0 0 14px 0 #00000011,0 10px 20px 0 #00000011!important;backdrop-filter:blur(16px)!important}#aisearch,#setting{border-radius:0px!important}.pill{border-radius:0px!important;box-shadow:0 0 14px 0 #00000011,0 10px 20px 0 #00000011!important}.settingbtn{padding:0 16px!important;border-radius:0px!important;background:#f9f9f9!important;height:40px!important;box-shadow:0 2px 4px 0 #0001!important}input#bgUrlInput{font-size:16px!important;padding:8px 13px!important;border-radius:0px!important;width:374px!important}.bar.show{padding-bottom:334px!important}.history,button.ai-engine-btn{border-radius:0px!important;box-shadow:0 0 14px 0 #00000011,0 10px 20px 0 #00000011!important}.pillicon{border-radius:0px!important}.bg.active{background:#ffffff57!important;backdrop-filter:blur(48px)!important}#aisearch{mix-blend-mode:unset!important;top:4px!important;right:5.5px!important;padding:16px 16px!important;padding-bottom:11px!important}#setting{background:#fff8!important;mix-blend-mode:unset!important;color:#000000!important;top:4px!important;right:61px!important;padding:16px 16px!important;padding-bottom:11px!important;width:fit-content!important}#setting.show{right:5.5px!important}@media (prefers-color-scheme:dark){:root{--textboxbg:#0008!important}#searchButton{background:#4cc1fe!important}.settingbtn{background:#111!important}.bg.active{background:#00000057!important}}';
            document.getElementById('jsBox').value = '';
            document.getElementById('addExt').click();
          ">拡張機能を追加<md-ripple></md-ripple></button>
        </div>

       </div>


    <label>CSS:</label>
    <textarea id="cssBox" placeholder="ここにCSSを入力"></textarea>
    <label>JavaScript:</label>
    <textarea id="jsBox" placeholder="ここにJavaScriptを入力"></textarea>
    <button id="addExt">読み込む</button>
    <button id="allDelete" class="all-delete">全て削除</button>
    <div class="ext-list" id="extList"></div>
  <script>
    // 拡張機能データの取得
    function getExtensions() {
      return JSON.parse(localStorage.getItem('extensions') || '[]');
    }
    // 拡張機能データの保存
    function saveExtensions(exts) {
      localStorage.setItem('extensions', JSON.stringify(exts));
    }
    // 拡張機能のリスト表示
    function renderList() {
      const list = document.getElementById('extList');
      list.innerHTML = '';
      const exts = getExtensions();
      exts.forEach((ext, i) => {
        const div = document.createElement('div');
        div.className = 'ext-item';
        div.innerHTML =
          '<b>拡張機能 ' + (i+1) + '</b>' +
          '<pre>CSS:\n' + (ext.css ? ext.css : '(なし)') + '</pre>' +
          '<pre>JS:\n' + (ext.js ? ext.js : '(なし)') + '</pre>' +
          '<button class="delete" data-id="' + ext.id + '">削除</button>';
        list.appendChild(div);
      });
      // 削除ボタンイベント
      document.querySelectorAll('.delete').forEach(btn => {
        btn.onclick = function() {
          const id = this.dataset.id;
          const newExts = getExtensions().filter(ext => ext.id !== id);
          saveExtensions(newExts);
          renderList();
        };
      });
    }
    // 拡張機能の全削除
    document.getElementById('allDelete').onclick = function() {
      saveExtensions([]);
      renderList();
    };
    // 拡張機能の追加
    document.getElementById('addExt').onclick = function() {
      const css = document.getElementById('cssBox').value;
      const js = document.getElementById('jsBox').value;
      if (!css && !js) return alert('CSSまたはJavaScriptを入力してください');
      const id = 'ext_' + Date.now();
      const exts = getExtensions();
      exts.push({ id, css, js });
      saveExtensions(exts);
      renderList();
      document.getElementById('cssBox').value = '';
      document.getElementById('jsBox').value = '';
    };
    // ページ読み込み時、リストのみ表示
    window.onload = function() {
      renderList();
    };
  </script>
  <script>
    function updateSmoothCorners() {
      // 対象: .smooth クラスを持つ要素
      const elements = document.querySelectorAll('.smooth');
    
      elements.forEach(el => {
        // 現在の computed style で --smooth-corners が使われているかチェック
        const style = getComputedStyle(el);
        const hasSmoothCorners = style.getPropertyValue('--smooth-corners');
    
        if (hasSmoothCorners !== '') {
          const height = el.offsetHeight;
          const width = el.offsetWidth;
          const smoothValue = `${(width / 50).toFixed(2)}, ${(height / 50).toFixed(2)}`;
          el.style.setProperty('--smooth-corners', smoothValue);
        }
      });
    }
    
    // 初回実行
    updateSmoothCorners();
    
    // ウィンドウサイズ変更時にも再計算
    window.addEventListener('resize', updateSmoothCorners);
    
    // DOM追加時にも対応（必要なら）
    const observer = new MutationObserver(updateSmoothCorners);
    observer.observe(document.body, { childList: true, subtree: true });
    </script>
    <script>
      if (CSS && 'paintWorklet' in CSS) CSS.paintWorklet.addModule('https://unpkg.com/smooth-corners')
    </script>
    
</body>
</html>
