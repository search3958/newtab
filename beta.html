<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>リンク集</title>
  <script>
if ("paintWorklet" in CSS) {
  const workletCode = `
    const drawSquircle=(ctx,geom,radii,smooth,lineWidth,color)=>{const defaultFill=color;const lineWidthOffset=lineWidth/2;ctx.beginPath();ctx.lineTo(radii[0],lineWidthOffset);ctx.lineTo(geom.width-radii[1],lineWidthOffset);ctx.bezierCurveTo(geom.width-radii[1]/smooth,lineWidthOffset,geom.width-lineWidthOffset,radii[1]/smooth,geom.width-lineWidthOffset,radii[1]);ctx.lineTo(geom.width-lineWidthOffset,geom.height-radii[2]);ctx.bezierCurveTo(geom.width-lineWidthOffset,geom.height-radii[2]/smooth,geom.width-radii[2]/smooth,geom.height-lineWidthOffset,geom.width-radii[2],geom.height-lineWidthOffset);ctx.lineTo(radii[3],geom.height-lineWidthOffset);ctx.bezierCurveTo(radii[3]/smooth,geom.height-lineWidthOffset,lineWidthOffset,geom.height-radii[3]/smooth,lineWidthOffset,geom.height-radii[3]);ctx.lineTo(lineWidthOffset,radii[0]);ctx.bezierCurveTo(lineWidthOffset,radii[0]/smooth,radii[0]/smooth,lineWidthOffset,radii[0],lineWidthOffset);ctx.closePath();if(lineWidth){ctx.strokeStyle=defaultFill;ctx.lineWidth=lineWidth;ctx.stroke()}else{ctx.fillStyle=defaultFill;ctx.fill()}};class SquircleClass{static get contextOptions(){return{alpha:true}}static get inputProperties(){return["--squircle-radius","--squircle-radius-top-left","--squircle-radius-top-right","--squircle-radius-bottom-right","--squircle-radius-bottom-left","--squircle-smooth","--squircle-outline","--squircle-fill"]}paint(ctx,geom,properties){const smoothRatio=10;const distanceRatio=1.8;const squircleSmooth=parseFloat(properties.get("--squircle-smooth")*smoothRatio);const individualRadiiProps=SquircleClass.inputProperties.slice(1,5);let squircleRadii=individualRadiiProps.map(prop=>{const value=properties.get(prop);return value?parseInt(value,10)*distanceRatio:NaN});let shorthand_R;if(squircleRadii.some(isNaN)){const radiusRegex=/([0-9]+[a-z%]*)/g;const radius_shorthand=properties.get("--squircle-radius").toString();const matches=radius_shorthand.match(radiusRegex);if(matches){shorthand_R=matches.map(val=>parseInt(val,10)*distanceRatio);while(shorthand_R.length<4){if(shorthand_R.length===1){shorthand_R.push(shorthand_R[0])}else if(shorthand_R.length===2){shorthand_R=[shorthand_R[0],shorthand_R[1],shorthand_R[0],shorthand_R[1]]}else if(shorthand_R.length===3){shorthand_R=[shorthand_R[0],shorthand_R[1],shorthand_R[2],shorthand_R[1]]}}}else{const defaultRadius=squircleRadii.every(isNaN)?8*distanceRatio:0;shorthand_R=[defaultRadius,defaultRadius,defaultRadius,defaultRadius]}}squircleRadii=squircleRadii.map((val,i)=>isNaN(val)?shorthand_R[i]:val);const squrcleOutline=parseFloat(properties.get("--squircle-outline"),10);const squrcleColor=properties.get("--squircle-fill").toString();const isSmooth=()=>{if(typeof properties.get("--squircle-smooth")[0]!=="undefined"){if(squircleSmooth===0){return 1}return squircleSmooth}else{return 10}};const isOutline=()=>{if(squrcleOutline){return squrcleOutline}else{return 0}};const isColor=()=>{if(squrcleColor){return squrcleColor}else{return"#f45"}};const maxRadius=Math.max(...squircleRadii);if(maxRadius<geom.width/2&&maxRadius<geom.height/2){drawSquircle(ctx,geom,squircleRadii,isSmooth(),isOutline(),isColor())}else{const minRadius=Math.min(geom.width/2,geom.height/2);drawSquircle(ctx,geom,squircleRadii.map(()=>minRadius),isSmooth(),isOutline(),isColor())}}}if(typeof registerPaint!=="undefined"){registerPaint("squircle",SquircleClass)}
  `;
  const blob = new Blob([workletCode], { type: 'application/javascript' });
  const blobURL = URL.createObjectURL(blob);
  CSS.paintWorklet.addModule(blobURL);
}
</script>
  <style>
    :root{
      --iconbg:#fff9;
      --glass-shadow: #fffb 0px 1.5px 3px inset,#fff7 0px -1.5px 3px inset;
    }
    body {
      margin: 0;
      font-family: sans-serif;
      background: url('https://search3958.github.io/newtab/bgimg/3958Glass6.webp') no-repeat center center fixed;
      background-size: cover;
    }



    @keyframes bg-blur {
      from {
        backdrop-filter:blur(0px) brightness(100%);
      }
      to {
        backdrop-filter:blur(24px) brightness(106%);
      }
    }


    body:before{
      content:" ";
      position:fixed;
      backdrop-filter:blur(24px) brightness(103%);
      height:100%;
      width:100%;
      pointer-events:none;

      animation: bg-blur cubic-bezier(.5,0,0,1) both;
      animation-timeline: view();
animation-range: entry 100% entry 130%;
    }
    * { scrollbar-width: none; }
    *::-webkit-scrollbar { display: none; }


    main#links-container {
        display: flex;
        flex-direction: column;
        align-content: center;
        align-items: center;
        
    }

    @keyframes main-fade-anm {
      from {
        opacity:0;
        pointer-events:none;
      }
      to {
        opacity:1;
      pointer-events:unset;
      }
    }


    #links-container {
      opacity: 0;
      transition: opacity 0.2s;
      padding-bottom:300px;
      position:relative;
      padding-top:50vh;

      animation: main-fade-anm cubic-bezier(.5,0,0,.7) both;
      animation-timeline: view();
      animation-range: entry 100% entry 150%;

    }
    #links-container.visible {
      opacity: 1;
    }

    .category {
      margin-bottom: 20px;
      gap: 16px;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      flex-direction: row;
      max-width:875px;
    
}
    .category-title { font-size: 18px; font-weight: bold; margin-bottom: 10px; width:100vw; text-align:center;}




    .appicon-bg {
      display: block;
      padding: 0px;
      border-radius: 8px;
      text-align: center;
      width: 100px;
      position:relative;
      height:105px;
      width:105px;
      mask-image:url('data:image/svg+xml;utf8,<svg width="105" height="105" viewBox="0  0 110 110" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 55C0 29.573 0 16.8595 7.65351 8.76409C8.01325 8.38358 8.38358 8.01325 8.76409 7.65351C16.8595 0 29.573 0 55 0V0C80.427 0 93.1405 0 101.236 7.65351C101.616 8.01325 101.987 8.38358 102.346 8.76409C110 16.8595 110 29.573 110 55V55C110 80.427 110 93.1405 102.346 101.236C101.987 101.616 101.616 101.987 101.236 102.346C93.1405 110 80.427 110 55 110V110C29.573 110 16.8595 110 8.76409 102.346C8.38358 101.987 8.01325 101.616 7.65351 101.236C0 93.1405 0 80.427 0 55V55Z" fill="black"/></svg>');
    }
    .appicon-img {
      height:95px;
      width:95px;
      margin:5px;
      object-fit: cover;
      border-radius: 4px;
    }
    .appicon-label {
      font-size: 12px;
      margin-top: 4px;
      position:absolute;
      bottom:10px;
      left:10px;
      backdrop-filter: brightness(100%);
      padding:4px;
      background:#fff0;
      border-radius:10px;
      scale:0.9;
      color:#0000;
      transition:all 0.5s cubic-bezier(.34,.24,0,1);
      max-width: 75px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      opacity:0;
    }
    
    .appicon-bg:hover>.appicon-label {
      backdrop-filter: brightness(160%) blur(8px);
      background:#fff6;
      scale:0.999;
      color:#000f;
      opacity:1;
    }

    @keyframes search-anm {
      from {
        scale:1;
      bottom:15px;
      }
      to {
        scale:0.3 0.4;
      bottom:-70px;
      }
    }
    .search-box{
      position:fixed;
      left:calc(50vw - 90px);
      height:50px;
      z-index:100;
      border-radius:100px;
      width:180px;
      /* animation: search-anm cubic-bezier(.6,0,0,1) both; */
      /* animation-timeline: view(); */
      /* animation-range: contain 0% contain 70%; */
      transition:all 0.7s linear(0, 0.379 5.6%, 0.66 11.7%, 0.855 18.5%, 0.924 22.3%, 0.976 26.4%, 1.021 33%, 1.037 41.1%, 1.005 72.8%, 1);
    }

    .search-box.show{
      left:calc(50vw - 170px);

      height:65px;
      width:340px;
    }

    .search-box-in{
      position:absolute;
      width:100%;
      height:100%;
      z-index:1001;
      border-radius:100px;
      backdrop-filter:blur(4px) brightness(130%);
      background:#fff9;
      box-shadow:var(--glass-shadow);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .any-box{
      position:fixed;
      left:calc(50vw - 150px);
      bottom:80px;
      height:110px;
      z-index:100;
      border-radius:36px;
      width:300px;
    }


    .any-box-in{
      position:absolute;
      width:100%;
      height:100%;
      z-index:1001;
      border-radius:27px;
      backdrop-filter:blur(4px) brightness(120%);
      background:#fff9;
      box-shadow:var(--glass-shadow);
      display: flex;
      align-items: center;
      justify-content: space-around;
    mask-image: paint(squircle);
    --squircle-radius: 24px;
    --squircle-smooth: 0.4;
    }

    #google-search-btn{
      background:none;
      border:none;
      color:#000;
      width: 0px;
      text-wrap-mode: nowrap;
      transition:all 0.7s linear(0, 0.379 5.6%, 0.66 11.7%, 0.855 18.5%, 0.924 22.3%, 0.976 26.4%, 1.021 33%, 1.037 41.1%, 1.005 72.8%, 1);
      filter:opacity(0) blur(4px);
    }

    .show #google-search-btn{
      width: 60px;
      filter:opacity(1) blur(0px);
    }
    #google-search-input{
      width:calc(100% - 45px);
      font-size:16px;
      outline:none;
      background:none;
      border:none;
      transition:all 0.7s linear(0, 0.379 5.6%, 0.66 11.7%, 0.855 18.5%, 0.924 22.3%, 0.976 26.4%, 1.021 33%, 1.037 41.1%, 1.005 72.8%, 1);
    }
    .show #google-search-input{
      width:calc(100% - 110px);
      font-size:24px;
    }

    #___gcse_0 {
        width: 80vw;
        height: calc(100vh - 200px);
        overflow: scroll;
        position: fixed;
        top: 0;
      left:calc(50vw - 40vw);
          
      border-radius:24px;
    }
    .gsc-control-cse{
      background:none!important;
      border:none!important;
      opacity:1;
      transition:0.2s opacity ease,0.2s scale ease;
    }
    .gsc-webResult.gsc-result{
      background:#fff5!important;
      border:none!important;
      backdrop-filter:blur(24px) brightness(120%);
      margin:10px 0!important;
      padding: 24px !important;
      /*
      border-radius: 32px;
      */
          mask-image: paint(squircle);
    --squircle-radius: 24px;
    --squircle-smooth: 0.4;
    }
    .gs-promotion .gs-visibleUrl, .gs-webResult .gs-visibleUrl {
      color:#0008!important;
    }
    .gs-promotion-text-cell{
      margin-left:0px!important;
    }
    
    a.gs-title,b {
    color: #000 !important;
}
.gsc-control-cse.loading{
  opacity:0.6;
}.gsc-control-cse.hide{
  opacity:0!important;
  scale:0.95;
  pointer-events:none;
}
.gsc-loading-fade .gsc-result-info, .gsc-loading-fade .gsc-loading-resultsRoot, .gsc-loading-resultsRoot, .gsc-loading-fade .gsc-loading-refinementsArea, .gsc-loading-fade .gsc-adBlock, .gsc-loading-fade .gsc-adBlockVertical, .gsc-loading-fade .gsc-adBlockNoHeight{
  opacity:1!important;
}

form.gsc-search-box.gsc-search-box-tools,.gsc-above-wrapper-area,table.gsc-completion-container{
  display:none!important;
}
.gsc-cursor-box.gs-bidi-start-align,.gcsc-more-maybe-branding-root {
    display: flex;
    flex-direction: row;
    justify-content: center;
}
.gsc-results{
  width:100%!important;
}
.gsc-control-cse{
  padding:32px 0px!important;
}
  </style>
</head>
<body>

  <div class="search-box liquid-glass">
   <div class="search-box-in">
    <input type="text" id="google-search-input" placeholder="検索，計算，質問"/>
    <button id="google-search-btn">検索</button>
   </div>
  </div>



  
<script async>
  (function(opts_){/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
'use strict';var f=this||self;function g(a){return a};var h;function k(a,b){this.h=a===l&&b||"";this.g=m}function n(a){return a instanceof k&&a.constructor===k&&a.g===m?a.h:"type_error:Const"}var m={},l={};function p(a,b){this.h=b===q?a:""}p.prototype.toString=function(){return this.h+""};function r(a){return a instanceof p&&a.constructor===p?a.h:"type_error:TrustedResourceUrl"}
function u(a,b){var c=n(a);if(!v.test(c))throw Error("Invalid TrustedResourceUrl format: "+c);a=c.replace(w,function(d,e){if(!Object.prototype.hasOwnProperty.call(b,e))throw Error('Found marker, "'+e+'", in format string, "'+c+'", but no valid label mapping found in args: '+JSON.stringify(b));d=b[e];return d instanceof k?n(d):encodeURIComponent(String(d))});return x(a)}var w=/%{(\w+)}/g,v=RegExp("^((https:)?//[0-9a-z.:[\\]-]+/|/[^/\\\\]|[^:/\\\\%]+/|[^:/\\\\%]*[?#]|about:blank#)","i"),y=/^([^?#]*)(\?[^#]*)?(#[\s\S]*)?/;
function z(a){var b=A;a=u(B,a);a=y.exec(r(a).toString());var c=a[3]||"";return x(a[1]+C("?",a[2]||"",b)+C("#",c))}var q={};function x(a){if(void 0===h){var b=null;var c=f.trustedTypes;if(c&&c.createPolicy){try{b=c.createPolicy("goog#html",{createHTML:g,createScript:g,createScriptURL:g})}catch(d){f.console&&f.console.error(d.message)}h=b}else h=b}a=(b=h)?b.createScriptURL(a):a;return new p(a,q)}
function C(a,b,c){if(null==c)return b;if("string"===typeof c)return c?a+encodeURIComponent(c):"";for(var d in c)if(Object.prototype.hasOwnProperty.call(c,d)){var e=c[d];e=Array.isArray(e)?e:[e];for(var t=0;t<e.length;t++){var D=e[t];null!=D&&(b||(b=a),b+=(b.length>a.length?"&":"")+encodeURIComponent(d)+"="+encodeURIComponent(String(D)))}}return b};function E(a,b){this.g=b===F?a:""}E.prototype.toString=function(){return this.g.toString()};var F={};/*

 SPDX-License-Identifier: Apache-2.0
*/
var G;try{new URL("s://g"),G=!0}catch(a){G=!1}var H=G;var I="alternate author bookmark canonical cite help icon license next prefetch dns-prefetch prerender preconnect preload prev search subresource".split(" ");var J=new k(l,"https://www.google.com/cse/static/style/look/%{versionDir}%{versionSlash}%{theme}.css"),K=new k(l,"https://www.google.com/cse/static/element/%{versionDir}%{versionSlash}default%{experiment}+%{lang}.css"),B=new k(l,"https://www.google.com/cse/static/element/%{versionDir}%{versionSlash}cse_element__%{lang}.js"),L=new k(l,"/");window.__gcse=window.__gcse||{};window.__gcse.ct=Date.now();
window.__gcse.scb=function(){var a=window.__gcse;M()||delete opts_.rawCss;var b=N(a.initializationCallback||a.callback);google.search.cse.element.init(opts_)&&("explicit"!==a.parsetags?"complete"===document.readyState||"interactive"===document.readyState?(google.search.cse.element.go(),null==b||b()):google.setOnLoadCallback(function(){google.search.cse.element.go();null==b||b()},!0):null==b||b())};
function N(a){if("function"===typeof a)return a;if("string"!==typeof a)return null;a=window[a];return"function"!==typeof a?null:a}function M(){var a;return!(null==(a=window.__gcse)?0:a.plainStyle)}
function O(a){var b=document.createElement("link");b.type="text/css";a:{if(a instanceof p)b.href=r(a).toString();else{if(-1===I.indexOf("stylesheet"))throw Error('TrustedResourceUrl href attribute required with rel="stylesheet"');if(a instanceof E)a=a instanceof E&&a.constructor===E?a.g:"type_error:SafeUrl";else{c:if(H){try{var c=new URL(a)}catch(d){c="https:";break c}c=c.protocol}else d:{c=document.createElement("a");try{c.href=a}catch(d){c=void 0;break d}c=c.protocol;c=":"===c||""===c?"https:":
c}a="javascript:"!==c?a:void 0}if(void 0===a)break a;b.href=a}b.rel="stylesheet"}return b};var P,A=opts_.usqp?{usqp:opts_.usqp}:{},Q=opts_.language.toLowerCase();P=opts_.cselibVersion?z({versionDir:opts_.cselibVersion,versionSlash:L,lang:Q}):z({versionDir:"",versionSlash:"",lang:Q});var R=window.__gcse.scb,S=document.createElement("script");S.src=r(P);var T,U,V,W=null==(V=(U=(S.ownerDocument&&S.ownerDocument.defaultView||window).document).querySelector)?void 0:V.call(U,"script[nonce]");(T=W?W.nonce||W.getAttribute("nonce")||"":"")&&S.setAttribute("nonce",T);S.type="text/javascript";
R&&(S.onload=R);document.getElementsByTagName("head")[0].appendChild(S);
if(M()){document.getElementsByTagName("head")[0].appendChild(O(opts_.cselibVersion?u(K,{versionDir:opts_.cselibVersion,versionSlash:L,experiment:opts_.uiOptions.cssThemeVersion&&4!==opts_.uiOptions.cssThemeVersion?"_v"+opts_.uiOptions.cssThemeVersion:"",lang:opts_.language}):u(K,{versionDir:"",versionSlash:"",experiment:"",lang:opts_.language})));var X,Y="v"+(opts_.uiOptions.cssThemeVersion||4);X=u(J,{versionDir:Y,versionSlash:Y?L:"",theme:opts_.theme.toLowerCase().replace("v2_","")});document.getElementsByTagName("head")[0].appendChild(O(X))};
})({
  "cx": "368d6e1513b974fd7",
  "language": "ja",
  "theme": "V2_DEFAULT",
  "uiOptions": {
    "resultsUrl": "",
    "enableAutoComplete": true,
    "enableImageSearch": false,
    "imageSearchLayout": "popup",
    "resultSetSize": "filtered_cse",
    "enableOrderBy": true,
    "orderByOptions": [{
      "label": "Relevance",
      "key": ""
    }, {
      "label": "Date",
      "key": "date"
    }],
    "overlayResults": false,
    "webSearchResultSetSize": 0,
    "webSearchExtendedRestricts": {
      "lr": "",
      "cr": "",
      "gl": "",
      "filter": 0,
      "sort": "",
      "as_oq": "",
      "as_sitesearch": ""
    },
    "queryParameterName": "q",
    "enableHistory": true,
    "numTopRefinements": 5,
    "enableRichSnippets": false,
    "hideElementBranding": false,
    "cssThemeVersion": 4,
    "isSafeSearchActive": false,
    "numTopAds": 3
  },
  "protocol": "https",
  "rawCss": ".gsc-control-cse{font-family:arial, sans-serif}.gsc-control-cse .gsc-table-result{font-family:arial, sans-serif}.gsc-refinementsGradient{background:linear-gradient(to left,rgba(255,255,255,1),rgba(255,255,255,0))}",
  "cse_token": "AEXjvhLVkGgu4xNNyr92NEPyjSc_:1763882197124",
  "isHostedPage": false,
  "exp": ["cc", "apo"],
  "cselibVersion": "db2c7696979b2a96",
  "usqp": "CAI\u003d"
});
</script>
<div class="gcse-search"></div>



  <div class="any-box liquid-glass">
   <div class="any-box-in">
    anybar-test
   </div>
  </div>

  
  <main id="links-container">

  </main>

  <script src="https://unpkg.com/fflate@0.8.2/umd/index.js"></script>
  <script>
    const getFileName = (path) => path.split('/').pop();

const loadZip = async (url) => {
  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error('ZIP fetch failed');
    const buffer = await response.arrayBuffer();
    const files = fflate.unzipSync(new Uint8Array(buffer));
    
    const imageMap = {};
    const entries = Object.entries(files);
    
    for (let i = 0; i < entries.length; i++) {
      const [path, data] = entries[i];
      const fileName = getFileName(path);
      const blob = new Blob([data.buffer], { type: 'image/webp' });
      imageMap[fileName] = URL.createObjectURL(blob);
      
      if (i % 10 === 0) await new Promise(r => setTimeout(r, 0));
    }
    return imageMap;
  } catch (err) {
    console.error('loadZip error', err);
    return {};
  }
};

const loadData = async () => {
  try {
    const zipUrl = 'https://search3958.github.io/newtab/lsr/icons-4-5.zip';
    const imageMap = await loadZip(zipUrl);

    const jsonUrl = 'https://search3958.github.io/newtab/links.json';
    const res = await fetch(jsonUrl);
    if (!res.ok) throw new Error('links.json fetch failed');
    const data = await res.json();

    const container = document.getElementById('links-container');

    (data.categories || []).forEach(category => {
      const categoryDiv = document.createElement('div');
      categoryDiv.className = 'category';

      const title = document.createElement('h2');
      title.className = 'category-title';
      title.textContent = category.title || '無題';
      categoryDiv.appendChild(title);

      (category.links || []).forEach(link => {
        const a = document.createElement('a');
        a.href = link.url || '#';

        const iconDiv = document.createElement('div');
        iconDiv.className = 'appicon-bg';
        if (link.bg) iconDiv.style.background = link.bg;

        const img = document.createElement('img');
        img.className = 'appicon-img';
        const src = imageMap[link.icon];
        img.alt = link.name || '';
        img.src = src || link.icon || '';

        const label = document.createElement('div');
        label.className = 'appicon-label';
        label.textContent = link.name || '';

        iconDiv.appendChild(img);
        iconDiv.appendChild(label);
        a.appendChild(iconDiv);
        categoryDiv.appendChild(a);
      });

      container.appendChild(categoryDiv);
    });

    let cachedRect = null;
    let lastScrollY = -1;

    const checkVisibility = () => {
      const currentScrollY = window.scrollY || window.pageYOffset;
      
      if (lastScrollY === currentScrollY && cachedRect) {
        const isVisible = cachedRect.top <= 0;
        container.classList.toggle('visible', isVisible);
        return;
      }
      
      cachedRect = container.getBoundingClientRect();
      lastScrollY = currentScrollY;
      
      const isVisible = cachedRect.top <= 0;
      container.classList.toggle('visible', isVisible);
    };

    window.addEventListener('scroll', checkVisibility);
    checkVisibility();

    if (window.addLinksAdIfNeeded) {
      window.addLinksAdIfNeeded(container);
    }
  } catch (err) {
    console.error('loadData error', err);
  }
};

loadData();

const searchInput = document.getElementById('google-search-input');
const searchBtn = document.getElementById('google-search-btn');
const searchBox = document.querySelector('.search-box');

function doGoogleSearch() {
  const q = searchInput.value.trim();
  if(q) {
    window.location.href = 'https://www.google.com/search?q=' + encodeURIComponent(q);
  }
}

searchBtn.addEventListener('click', doGoogleSearch);
searchInput.addEventListener('input', function() {
  if (searchInput.value.trim()) {
    searchBox.classList.add('show');
  } else {
    searchBox.classList.remove('show');
  }
});

(function syncToGscInput() {
  try {
    const src = document.getElementById('google-search-input');
    const dst = document.getElementById('gsc-i-id1');
    const cse = document.querySelector('.gsc-control-cse');
    const resultsRoot = document.querySelector('.gsc-resultsRoot.gsc-tabData.gsc-tabdActive');
    if (src && dst) {
      if (!window._gscSync) window._gscSync = { lastValue: '', timer: null, lastInputTime: 0, updating: false, lastResults: '' };
      const sync = window._gscSync;
      let resultsChanged = false;
      if (resultsRoot) {
        const html = resultsRoot.innerHTML;
        if (sync.lastResults !== undefined && sync.lastResults !== html) {
          resultsChanged = true;
        }
        sync.lastResults = html;
      }
      if (dst.value !== src.value) {
        if (cse) cse.classList.add('loading');
        dst.value = src.value;
        dst.dispatchEvent(new Event('input', {bubbles:true}));
        sync.lastInputTime = Date.now();
        sync.lastValue = src.value;
        sync.updating = true;
        sync.waitingForResult = true;
      }
      if (sync.lastValue !== '' && Date.now() - sync.lastInputTime > 200) {
        const btn = document.querySelector('.gsc-search-button.gsc-search-button-v2');
        if (btn) btn.click();
        sync.lastValue = '';
        sync.lastInputTime = Date.now();
        sync.waitingForResult = true;
      }
      if (cse && resultsChanged && sync.waitingForResult) {
        cse.classList.remove('loading');
        sync.updating = false;
        sync.waitingForResult = false;
      }
      if (cse && sync.waitingForResult) {
        cse.classList.add('loading');
      }
      if (cse) {
        if (src.value.length === 0) {
          cse.classList.add('hide');
        } else {
          cse.classList.remove('hide');
        }
      }
    }
  } catch(e) { /* 無視 */ }
  setTimeout(syncToGscInput, 100);
})();

let lastResultsHTML = '';
const observer = new MutationObserver(() => {
  const resultsRoot = document.querySelector('.gsc-resultsRoot.gsc-tabData.gsc-tabdActive');
  if (resultsRoot) {
    const currentHTML = resultsRoot.innerHTML;
    if (lastResultsHTML && lastResultsHTML !== currentHTML) {
      const cse = document.querySelector('.gsc-control-cse');
      if (cse) cse.classList.remove('loading');
      window._gscSync.waitingForResult = false;
    }
    lastResultsHTML = currentHTML;
  }
});

if (document.querySelector('.gsc-resultsRoot.gsc-tabData.gsc-tabdActive')) {
  observer.observe(document.querySelector('.gsc-resultsRoot.gsc-tabData.gsc-tabdActive'), {
    childList: true,
    subtree: true
  });
}

function scrollAnimUpdate() {
  const scrollY = window.scrollY || window.pageYOffset;
  const vh = window.innerHeight;
  const from = 0;
  const to = 0.5 * vh;
  let t = (scrollY - from) / (to - from);
  t = Math.max(0, Math.min(1, t));

  const searchBox = document.querySelector('.search-box');
  if (searchBox) {
    const scaleX = 1 - 0.7 * t;
    const scaleY = 1 - 0.6 * t;
    const bottom = 15 * (1 - t) + (-70) * t;
    searchBox.style.transform = `scale(${scaleX},${scaleY})`;
    searchBox.style.bottom = `${bottom}px`;
  }
}

window.addEventListener('scroll', scrollAnimUpdate);
window.addEventListener('resize', scrollAnimUpdate);
document.addEventListener('DOMContentLoaded', function() {
  scrollAnimUpdate();
  setTimeout(scrollAnimUpdate, 0);
});

function loadAfterloadJS() {
  if (window._afterloadLoaded) return;
  window._afterloadLoaded = true;
  setTimeout(function() {
    var s = document.createElement('script');
    s.src = 'beta/afterload.js';
    document.body.appendChild(s);
  }, 200);
}

window.addEventListener('DOMContentLoaded', loadAfterloadJS);
window.addEventListener('load', loadAfterloadJS);

  </script>
</body>
</html>
