<!DOCTYPE html>
<html lang="ja">
<head>
  <script async src="https://fundingchoicesmessages.google.com/i/pub-6151036058675874?ers=1"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js"></script>
  <!--google tags-->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6151036058675874"
     crossorigin="anonymous"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7N56NHPY3C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7N56NHPY3C');
</script>
  <style>
    :root {
  --primary:#0F6CBD;
  --white:#fffa;
  --bgcolor:#fff6;
  --radius:11px;
  --radius-plus:21px;
}

::-webkit-scrollbar {
  display: none;  /* Chrome, Safari, Edge */
}

.css-ver:after {
  content: "6-WinUI"
}

body {
  background-color: #000;
  background-image: url(https://search3958.github.io/newtab/bgimg/bg1.webp);
  overflow-x: hidden;
  background-position: center center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  background-size: cover;
  margin: 0;
  padding: 1px;
  height: 100vh;
}

* {
  transform-style: preserve-3d;
  font-family: "Work Sans","Yu Gothic Pr6N R", sans-serif;
  line-height: 1.5;
}

button {
  color: #000
}

.controls {
  position: fixed;
  top: 20px;
  left: 20px;
  background: #fff;
  padding: 15px;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, .1)
}

link-box {
  display: inline-block;
  margin: 10px;
  transform-style: preserve-3d;
  color: #000
}

link-box a {
  text-decoration: none;
  color: inherit;
  transform-style: preserve-3d;
  transition: 0.5s all cubic-bezier(.33, 0, 0, 1)
}

link-box .box {
  transform-style: preserve-3d;
  text-align: center
}

link-box .container {
  border: #fff0 0 solid;
  text-align: left;
  position: relative;
  width: 200px;
  height: 120px;
  transform-style: preserve-3d;
  transition: 0.5s all cubic-bezier(.33, 0, 0, 1), transform 0.2s ease-out;
  border-radius: 44px;
}

link-box .container img {
  position: absolute;
  width: 100%;
  height: 100%;
  transition: transform 0.2s ease-out, filter 0.2s ease-out, opacity 0.3s ease-out
}

link-box .container img.hidden {
  opacity: 0;
  pointer-events: none
}

link-box .container:hover {
  transform: rotateY(var(--x, 0deg)) rotateX(calc(var(--y, 0deg) * -1))
}

link-box .container:hover img:nth-child(1):not(.hidden) {
  transform: translate(var(--x1, 0), var(--y1, 0)) scale(1.02);
  filter: drop-shadow(0 1mm 3mm #0003)
}

link-box .container:hover img:nth-child(2):not(.hidden) {
  transform: translate(var(--x2, 0), var(--y2, 0)) scale(1.07);
  filter: drop-shadow(0 1mm 3mm #0003)
}

link-box .container:hover img:nth-child(3):not(.hidden) {
  transform: translate(var(--x3, 0), var(--y3, 0)) scale(1.13);
  filter: drop-shadow(0 1mm 3mm #0003)
}

.links {
  justify-content: center;
  align-items: center;
  display: flex;
  flex-wrap: wrap
}

#bg {
  overflow: scroll;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: calc(100vh + 1px);
  color: #fff;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(0);
  background: #0000;
  transition: all 0.3s cubic-bezier(.34, 0, .03, 1.01), height 0s ease;
  z-index: 1;
  pointer-events: none
}

#shortcuts {
  overflow: scroll;
  transform: translateY(50vh);
  scale:1;
  filter: blur(40px);
  opacity: 0;
  transition:all 0.167s cubic-bezier(1 , 0 , 1 , 1),opacity 0.167s cubic-bezier(.71,0,.45,1);
  z-index: 2;
  height: 100vh
}

#shortcuts.active {
  filter: blur(0);
  transform: translateY(1px);
  opacity: 1;
  scale:1;
  transition: all 0.35s cubic-bezier(0, 0, 0, 1);
  
}

#bg.active {
  backdrop-filter: blur(48px);
  background: var(--bgcolor);
  pointer-events: auto
}

/*.engine {
  position: fixed;
  top: calc(50vh - 80px);
  right: 50vw;
  transform: translateX(50%);
  backdrop-filter: blur(10px);
  background: #fff5;
  border-radius: 100px;
  padding: 8px 11px;
  display: inline-block;
    opacity:1;
  filter:blur(0px);
  transition:all 0.5s ease;
}*/
.engine.ai {
  opacity:0;
  filter:blur(24px);
  top: calc(50vh - 110px);
}
.engine {
  position: fixed;
  top: calc(50vh - 80px);
  right: 50vw;
  transform: translateX(50%);
  display: flex;
  gap: 10px;
  opacity:1;
  filter:blur(0px) drop-shadow(0 0 20px #fff);
  width:fit-content;
  color:#000;
  transition:all 0.5s ease;
}

.enginebtn {
  display: none;
}

.enginelbl {
  position: relative;
  padding: 5px 10px;
  cursor: pointer;
  font-size: 16px;
  transition: color 0.3s;
}

.enginelbl::before {
    content: "";
    position: absolute;
    left: calc(50% - 10px);
    bottom: -5px;
    width: 20px;
    height: 4px;
    background-color: var(--primary);
    border-radius: 2px;
    transform: scale(0);
    transition: transform 0.3s cubic-bezier(.44,0,.02,1);
}
.enginebtn:checked + .enginelbl::before {
  transform: scale(1);
}

.search {
  position: fixed;
  top: calc(50vh - 28.5px);
  right: 50vw;
  transform: translateX(50%);
  backdrop-filter: blur(10px);
  background:var(--bgcolor);
  padding: 2px;
  border-radius:var(--radius);
  box-shadow: 0 2px 80px #0001;
}
.search.ai{
 background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 628 628' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E"),radial-gradient(circle at 94% 95%, hsla(54,100%,50%,0.1) 3%,transparent 21%),radial-gradient(circle at 89% 34%, hsla(213,100%,50%,0.1) 1%,transparent 33%),radial-gradient(circle at 15% 44%, hsla(309,100%,50%,0.1) 0%,transparent 55%);background-blend-mode:overlay,normal,normal,normal; 
}

.searchtext {
  font-size: 24px;
  padding: 6px 16px;
  background: none;
  border: none;
  outline: none;
  border-radius: 14px;
  width:270px;
  transition:all 0.5s cubic-bezier(.19,1.37,.28,1);
}
.searchtext.ai{
  width:450px;
}
.linktext {
  margin: 20px;
  text-align: center;
  font-size: 24px
}

.searchbtn {
  border: none;
  background: none;
  font-size: 24px !important;
  padding: 4px;
  height: 32px;
  position: relative;
  top: 4px;
  right: 6px;
  border-radius: 10px;
  transition: 0.3s all ease
}

.searchbtn:active {
  background: #0002;
  scale: 1.2
}

.bar {
  z-index: 3;
  backdrop-filter: blur(10px);
  background:var(--bgcolor);
  padding: 6px 12px;
  border-radius: var(--radius);
  font-size: 18px;
  width: fit-content;
  position: fixed;
  top: 8px;
  right: 64px;
  display: flex;
}


.aibar {
  z-index: 3;
  backdrop-filter: blur(10px);
  background-color:hsla(271.9118097106005,100%,39%,1);background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 1799 1799' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E"),radial-gradient(circle at 68% 22%, hsla(257.0631139418657,95%,51%,0.68) 15%,transparent 58%),radial-gradient(circle at 100% 58%, hsla(213.38664335363055,84%,51%,1) 7%,transparent 70%),radial-gradient(circle at 28% 16%, hsla(280.8866433536305,100%,50%,0.43) 15%,transparent 74%);background-blend-mode:overlay,normal,screen,normal;
  padding: 6px 4px;
  border-radius: var(--radius);
  font-size: 18px;
  width: fit-content;
  position: fixed;
  top: 8px;
  right: 8px;
  display: flex;
  transition: all 0.7s cubic-bezier(.19, 1.35, .12, 1);
}

.aibar.active{
  background:#fffa;
}

.batteryicon {
  position: relative;
  top: 4px;
  right: 2px;
  color: #ff7a7a
}

#batteryStatus {
  z-index: 3;
  backdrop-filter: blur(10px);
  background: #000a;
  padding: 6px 12px;
  border-radius:var(--radius);
  font-size: 18px;
  width: fit-content;
  position: fixed;
  top: 8px;
  left: 8px;
  display: flex;
  COLOR: #fff;
  font-weight: 550;
  display: none
}

.aibg {
  position:fixed;
  top:-10vh;
  right:-10vw;
            width:20vw;
            height: 20vh;
  border-radius:calc(40vh + 40vw);
            background-image: url('https://search3958.github.io/newtab/bgimg/bg4.webp');
  background-position: center center;
  background-repeat: no-repeat;
  background-attachment: fixed;          
  background-size: cover;
            transition: all 0.5s cubic-bezier(.34,0,0,1);
  filter:blur(100px);
  opacity:0;
        }
        .aibg.active {
          filter:blur(0px);
          height:100vh;
          width:100vw;
            opacity: 1;
          border-radius:0vh;
          top:0px;
          right:0px;
        }

.aibtn {
  color:#fff;
  margin:0px;
  cursor: pointer;
  border: none;
  background: none;
  border-radius: 5px;
  transition: all 0.3s ease;
  position: relative;
  top: 2px
}

.aibtn.active{
  color:#000;
}

.btn {
  margin-left: 2px;
  margin-right: -7px;
  cursor: pointer;
  border: none;
  background: none;
  border-radius: 5px;
  transition: transform 0.3s ease, opacity 0.3s ease;
  position: relative;
  top: 1px
}

p {
  margin-bottom: 8px;
  margin-top: 0
}

.menu {
  z-index: 4;
  backdrop-filter: blur(16px);
  background-color: #fff6;
  padding: 16px;
  margin: 10px 0;
  border-radius: 30px;
  transform: scale(0);
  transition: all 0.7s cubic-bezier(.19, 1.35, .12, 1);
  width: content-fit;
  filter: blur(16px);
  position: fixed;
  opacity: 0;
  box-shadow: 0 5px 20px #0002
}


.bar.transparent {
  opacity: .6;
}

#hueRotation {
  appearance: none;
  width: calc(100% - 58px);
  height: 8px;
  border-radius: 100px;
  background: linear-gradient(to right, hsl(0, 100%, 65%), hsl(60, 100%, 65%), hsl(120, 100%, 65%), hsl(180, 100%, 65%), hsl(240, 100%, 65%), hsl(300, 100%, 65%), hsl(360, 100%, 65%));
  cursor: pointer;
  border: none;
  transition: all 0.6s cubic-bezier(.2, 0, .01, 1);
  opacity: .6;
  margin-top: 10px;
}

#hueRotation::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  border: none;
  border-radius: 9999px;
  background: #fff5;
  box-shadow: none;
  backdrop-filter: blur(10px);
  transition: all 0.6s cubic-bezier(.2, 0, .01, 1);
    border: solid 6px #fff;
}

:has(#colorMode:checked) #hueRotation {
  opacity: 1
}

#clock {
  position: relative;
  top:2px;
  margin-right: 2px
}

input[type="checkbox"] {
  display: none; /* チェックボックスを非表示 */
}

label.switch > span {
    font-size: 25px;
    padding: 1px;
}

input[type="checkbox"] + .switch {
    width: 26px;
    height: 26px;
    background: #dedede8a;
    border-radius: 8px;
    transition: background 0.3s ease;
    display: flex;
    position: relative;
    top: 2px;
    margin-right: 7px;
    margin-left: 2px;
    color: #595959c2;
    margin-bottom: 4px;
    box-shadow: #0003 0px 1px 3px 0px;
}

input[type="checkbox"]:checked + .switch {
    background: var(--primary);
    color: #ffffff;
}

.line {
  width: calc(100% - 4px);
  margin: 10px 2px;
  padding: 1px;
  background: #0003;
  border-radius: 10px
}
#imageUrl {
    border: none;
    background: #fff9;
    width: 224px;
    padding: 0px;
    padding-left: 10px;
    border-radius: var(--radius);
    outline: none;
    height: 36px;
    width: calc(100% - 6px);
    border-bottom: #000a 2px solid;
}
#imageUrl:focus {
    border-bottom-color: var(--primary);
}
.pbutton {
    padding: 8px 0px;
    border-radius: var(--radius);
    border: none;
    margin-top: 8px;
    background: var(--primary);
    color: #fff;
    width: 100%;
}
.sbutton {
    padding: 8px 0px;
    border-radius: var(--radius);
    border: none;
    margin-top: 8px;
    background: #f5f5f5;
    color: #000;
    width: 100%;
}
.history {
  position: fixed;
  top: calc(50vh + 30px);
  right: 50vw;
  transform: translateX(50%);
  opacity:1;
  filter:blur(0px);
  transition:all 0.5s ease;
}

.history.ai {
  opacity:0;
  filter:blur(24px);
  top: calc(50vh + 60px);
}

.deletehistory {
  font-size: 20px !important;
  margin: 0;
  margin-bottom: -5px;
  position:relative;
  top:2px;
}

a {
  color: #000;
  text-decoration: none !important
}

.block {
  display: block;
  margin-bottom: 8px;
  color:#00;
}

.history a,
.clear-button {
  backdrop-filter: blur(10px);
  font-size: 16px;
  border: none;
  margin: 4px;
  background:var(--bgcolor);
  padding: 4px 10px;
  border-radius:var(--radius);
  color: #000;
  text-decoration: none !important;
  z-index: 1;
  display: inline-block;
  min-width:12px;
  max-width: 5.5vw;
  text-align:center;
  overflow: scroll;
  white-space: nowrap
}

.clear-button {
  position: relative;
  bottom: 12.5px;
  padding-bottom: 0px;
  padding:3.5px 7px;
}

input::placeholder {
  color: #0005;
  font-weight: 400;
  transition:all 0.5s ease;
  font-size:20px;
}
.settingcontainer {
    display: flex;
    flex-direction: column;
    gap: 10px;
    position: absolute;
    right: 16px; /* 右に20pxの余白を設定 */
  top:48px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    z-index: 4;
  height: calc(100vh - 48px);
  overflow:scroll;
}

.item {
    color: #000;
    transform: translateY(-20px);
    opacity: 0;
    visibility: hidden;
    transition: transform 0.8s cubic-bezier(.26,1.51,.42,1), opacity 0.2s ease;
    width: 340px;
  font-size:24px;
  margin-bottom:8px;
}
.settingcard{
  background:var(--bgcolor);
  border-radius:var(--radius-plus);
  padding:10px;
  color:#000!important;
  font-size:16px;
}

.blur-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #fff1;
    backdrop-filter: blur(16px);
    opacity: 0;
    transition: opacity 0.3s ease;
  z-index:2;
}
.flexcard{
  display:flex;
  gap:8px;
}

.noclick{
  pointer-events: none;
}
.imgbtn {
    height: 120px;
    background: #fff7;
    border-radius: var(--radius);
    width: 100%;
    margin-bottom: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    background-size: cover;
    color: #000;
}
.help {
  text-align: center;
  position: fixed;
  bottom: 8px;
  right: 50vw;
  transform: translateX(50%);
  color: #0009
}

.linktext {
  color: #000
}
.edge {
  display: none;
  height: calc(100vh);
  width: calc(100vw);
  padding: 0px;
  margin: 0px;
  position: fixed;
  bottom: -21px;
  right: -21px;
  border: 0px solid #00B2FF;
  filter: blur(0px);
  border-radius: 16px;
  transition: all 0.7s cubic-bezier(.34,0,0,1);
  pointer-events: none;
  z-index: 1;
}

.edge.active {
  display: block;
  border: 20px solid #00B2FF;
  border-image: linear-gradient(to right, #348ceb, #e534eb) 1;
  filter: blur(32px);
  height: calc(100vh + 2px);
  width: calc(100vw + 2px);
}

.battery-container {
            position: relative;
            width: 100px;
            height: 62px;
            overflow: hidden;
  background:var(--bgcolor);
        }

        .battery-fill {
            width: 100%;
            position: absolute;
            bottom: 0;
            background: linear-gradient(to top, #18A9F244, #3091FF44);
            transition: height 0.5s ease;
        }

        .battery-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: black;
          filter:;
        }
.widget{
  position:fixed;
  bottom:48px;
  left: 50%;
  transform: translateX(-50%);
  display:flex;
  gap:16px;
  align-items: center;
}

#weatherBox {
      width: 230px;
      height: 62px;
      color: white;
      padding: 10px 16px;
      box-sizing: border-box;
      background: linear-gradient(180deg, #58A6FFCC 0%, #486DFFCC 100%);
  transition:background 0.3s ease;
  display:flex;
  justify-content: space-between;
    }
    /* 温度は上部に大きく表示 */
    .temperature {
      font-size: 2em;
      margin: 0;
    }
    /* 位置情報（地域） */
    .location {
      font-size: 0.7em;
      margin: 0;
     
    }
.weather {
      font-size: 0.9em;
      margin: 0;
  margin-top:3px;
    }


.analog-clock-container {
      display: flex;
      align-items: center;
      width: 130px;
      height: 62px;
      background:var(--bgcolor);
    }
    .date-display {
      margin-left: 10px;
      font-size: 12px;
      color: #333;
      text-align: center;
      line-height: 1.2;
    }
    .date-display span {
      display: block;
      text-align: left;
    }
.stopwatch-wrapper {
      width: 160px;
      height: 62px;
      display: flex;
      align-items: center;
      background:#5712A7BB;
  justify-content: center;
    }

    .stopwatch-buttons {
      display: flex;
      align-items: center;
      gap:8px;
    }

    .stopwatch-button {
      width: 36.4px;
      height: 40px;
      background-color: #B6A6FF;
      color: #441F84;
      border: none;
      border-radius: 4px;
      font-size: 20px;
      cursor: pointer;
    }

    /* 右側の時間表示 */
    .time-display {
      font-size: 18px;
      color: #fff;
      text-align: center;
      margin-left:8px;
    }
.stopwatchicon{
  position:relative;
  top:4px;
  right:1px;
}
.widgetctn{
  backdrop-filter: blur(10px);
  border-radius:var(--radius);
}
.recom{
  background:var(--bgcolor);
  padding:0px;
  height: 62px;
}
.shadow{
  box-shadow: 0px 8px 8px 0px rgba(0, 0, 0, 0.08), 0px 0px 4px 0px rgba(0, 0, 0, 0.2);
}
.ad{
  text-align:center;
}
@media (prefers-color-scheme:dark) {
  :root {
    --primary: #29a1ee;
    --bgcolor:#0006;
  }
  .battery-text,#month-day,#day-of-week {
    color:#fff;
  }
  .help {
    color: #fff9
  }

  input::placeholder {
    color: #fff5;
    font-weight: 300
  }

  button {
    color: #fff
  }

  .search {
    background: #0007;
    color: #fff
  }

  .bar {
    background: #0006;
    color: #fff
  }

  .menu {
    background: #0007;
    color: #fff
  }

  [switch] {
    --_background: #ccc3
  }

  #imageUrl {
    background: #0008;
    color: #fff
  }

  .searchtext {
    color: #fff
  }

  .sbutton {
    background: #000;
    color:#fff;
  }

  #bg.active {
    background: #0008
  }

  #batteryStatus {
    background: #fff9;
    color: #000
  }
  .settingcard {
    color:#fff;
  }
  .batteryicon {
    color: #db1010
  }

  .history a,
  .clear-button {
    background: #0006;
    color: #fff
  }

  a {
    color: #fff;
    text-decoration: none !important
  }

  .linktext {
    color: #fff
  }

  link-box {
    color: #fff
  }
  .engine{
    color:#000;
    filter:blur(0px) drop-shadow(0 0 20px #fff);
  }
  .pbutton{
    color:#000;
  }
  p{
    color:#fff!important;
  }
}
    </style>
<link rel="icon" href="https://search3958.github.io/favicon-newtab.svg">
<script type="text/javascript" src="//typesquare.com/3/tsst/script/ja/typesquare.js?67afe5719990420aa8d92d04ac1e02e5" charset="utf-8"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@48,400,0,200" />
  <meta charset="UTF-8">
  <title>Newtab3</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
  if (CSS && 'paintWorklet' in CSS) {
    CSS.paintWorklet.addModule('https://unpkg.com/smooth-corners');
  }
</script>
</head>
<body>
  <div class="edge"></div>
  <div class="aibg"></div>
  
  <p class="help">スクロールしてショートカットを表示します</p>
  <div class="bar shadow"><div id="clock">9:41 AM</div>
    <button class="btn" id="showBtn"><span class="material-symbols-rounded">
page_info
</span></button></div>
  <div class="aibar shadow">
    <button class="aibtn"><span class="material-symbols-rounded">
frame_inspect
</span></button></div>
  
  <div class="settingcontainer">
    
        <div class="item noclick">アイコン</div>
        <div class="item">
          <div class="settingcard flexcard shadow">
            <input type="checkbox" id="colorMode">
<label for="colorMode" class="switch">
  <span class="material-symbols-rounded">
check
</span>
  
</label>
             <input type="range" id="hueRotation" min="0" max="360" value="0">
             </div>
          </div>
        <div class="item">背景画像</div>
        <div class="item">
    <div class="settingcard shadow">
      <div class="flexcard">
      <div onclick="changeText1()" style="background-image:url('https://search3958.github.io/newtab/bgimg/pre-1.webp')" class="imgbtn"></div>
    <div onclick="changeText2()" style="background-image:url('https://search3958.github.io/newtab/bgimg/pre-2.webp')" class="imgbtn"></div>
      <a class="imgbtn" href="https://search3958.github.io/project/images/">もっと表示</a>
      </div>
      <input type="text" id="imageUrl" placeholder="画像URLを入力" />
      <div class="flexcard" style="gap:8px">
    <button class="pbutton shadow" onclick="updateBackground()">適用</button>
    <button class="sbutton shadow" onclick="resetBackground()">リセット</button>
    </div>
      </div>
    </div>
    <div class="item">情報</div>
        <div class="item">
    <div class="settingcard shadow" style="padding-left:16px;">
      <a class="block" href="https://search3958.github.io">Search 3958</a>
      <a class="block" href="https://search3958.github.io/newtab/newtab-simple.html">Newtab简易版</a>
    <a class="block" href="https://search3958.github.io/i/newtab/?section=content1-1.html">Newtab 3の詳細</a><div class="line"></div><p>HTMLバージョン:6-WinUI</p><p class="css-ver">CSSバージョン:</p><p id="js-ver">JavaScriptが作動していません</p>
  </div>
    </div>
          </div>
    
  <div id="batteryStatus" class="shadow"></div>
  
<div class="engine">
  <input id="google" class="enginebtn" type="radio" name="engine" value="https://www.google.com/search" checked> 
  <label for="google" class="enginelbl">Google</label>
  <input id="bing" class="enginebtn" type="radio" name="engine" value="https://www.bing.com/search"> 
  <label for="bing" class="enginelbl">Bing</label>
  <input id="yahoo" class="enginebtn" type="radio" name="engine" value="https://search.yahoo.com/search"> 
  <label for="yahoo" class="enginelbl">Yahoo</label>
  <input id="naver" class="enginebtn" type="radio" name="engine" value="https://search.naver.com/search.naver"> 
  <label for="naver" class="enginelbl">Naver</label>
</div>

<form class="search shadow" id="searchForm" method="get">
  <input class="searchtext" autocomplete="off" type="text" id="searchInput" name="q" placeholder="検索" required>
  <button class="searchbtn" type="button"><span class="material-symbols-rounded searchicon">search</span></button>
</form>

<div class="history" id="history"></div>

  <div class="widget">
    
    
<div id="weatherBox" class="widgetctn shadow">
    <div>
    <p class="weather">--</p>
    <p class="location">取得中</p>
      </div>
  <p class="temperature">--°C</p>
  </div>
    
    
    <div class="analog-clock-container widgetctn shadow">
    <div class="date-display" id="date-display">
      <span id="month-day" style="font-size: 1.3em!important;"></span>
      <span id="day-of-week"></span>
    </div>
  </div>
      
      <div class="stopwatch-wrapper widgetctn shadow">
    <!-- 左側ボタン -->
    <div class="stopwatch-buttons">
      <!-- 再生/一時停止ボタン -->
      <button id="playPauseBtn" class="stopwatch-button">
        <span class="material-symbols-rounded stopwatchicon">play_arrow</span>
      </button>
      <!-- リセットボタン -->
      <button id="resetBtn" class="stopwatch-button">
        <span class="material-symbols-rounded stopwatchicon">refresh</span>
      </button>
    </div>
    <!-- 右側の時間表示 -->
    <div class="time-display" id="timeDisplay">00:00</div>
  </div>
    
    <div class="recom widgetctn shadow">
      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6151036058675874"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:130px;height:62px"
     data-ad-client="ca-pub-6151036058675874"
     data-ad-slot="2601158311"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
    </class>
    
    </div>

   <div class="battery-container widgetctn shadow">
        <div id="battery-fill" class="battery-fill"></div>
        <div id="battery-text" class="battery-text">100%</div>
    </div>
  </div>
    
  <div id="bg">
    <div id="shortcuts">
  <div class="linktext">Google</div>
  <div class="links">
    <link-box href="https://mail.google.com/" bg-color="var(--white)" img="gmail">Gmail</link-box>
    <link-box href="https://keep.google.com/" bg-color="var(--white)" img="keep">Keep</link-box>
    <link-box href="https://classroom.google.com/" bg-color="var(--white)" img="classroom">Classroom</link-box>
    <link-box href="https://www.youtube.com/" bg-color="var(--white)" img="youtube">Youtube</link-box>
    <link-box href="https://docs.google.com/document/" bg-color="var(--white)" img="document">Document</link-box>
    <link-box href="https://docs.google.com/presentation/" bg-color="var(--white)" img="slide">Slide</link-box>
    <link-box href="https://docs.google.com/spreadsheets/" bg-color="var(--white)" img="spreadsheet">Spreadsheet</link-box>
    <link-box href="https://translate.google.com/" bg-color="var(--white)" img="translate">Translate</link-box>
    <link-box href="https://gemini.google.com/app" bg-color="var(--white)" img="gemini">Gemini</link-box>
    <link-box href="https://remotedesktop.google.com/" bg-color="var(--white)" img="remotedesktop">リモートデスクトップ</link-box>
    <link-box href="https://drive.google.com/" bg-color="var(--white)" img="drive">ドライブ</link-box>
    <link-box href="https://about.google/products/" bg-color="var(--white)" img="products">Product</link-box>
  </div>
  <div class="linktext">学習と作業効率化</div>
  <div class="links">
    <link-box href="https://monoxer.com/" bg-color="#459CF8" img="monoxer">Monoxer</link-box>
    <link-box href="https://chat.openai.com/" bg-color="black" img="chatgpt">Chat GPT</link-box>
    <link-box href="https://github.com/" bg-color="var(--white)" img="github">GitHub</link-box>
    <link-box href="https://copilot.github.com/" bg-color="var(--white)" img="copilot">Copilot</link-box>
    <link-box href="https://codepen.io/" bg-color="black" img="codepen">Codepen</link-box>
    <link-box href="https://claude.ai/" bg-color="var(--white)" img="claude">Claude</link-box>
    <link-box href="https://www.canva.com/" bg-color="var(--white)" img="canva">Canva</link-box>
    <link-box href="https://www.microsoft.com/microsoft-365" bg-color="var(--white)" img="microsoft365">Microsoft 365</link-box>
    <link-box href="https://turbowarp.org/" bg-color="var(--white)" img="turbowarp">TurboWarp</link-box>
    <link-box href="https://kahoot.com/" bg-color="#401A89" img="kahoot">Kahoot</link-box>
    <link-box href="https://www.figma.com/files/" bg-color="var(--white)" img="figma">Figma</link-box>
    <link-box href="https://discord.com/channels/@me" bg-color="linear-gradient(0deg, rgba(54, 67, 203, 1), rgba(88, 101, 242, 1))" img="discord">Discord</link-box>
  </div>
  <div class="linktext">ショッピング</div>
  <div class="links">
    <link-box href="https://www.amazon.com/" bg-color="var(--white)" img="amazon">Amazon</link-box>
    <link-box href="https://www.aliexpress.com/" bg-color="var(--white)" img="aliexpress">AliExpress</link-box>
    <link-box href="https://www.wish.com/" bg-color="#70DF80" img="wish">Wish</link-box>
    <link-box href="https://jp.mercari.com/" bg-color="var(--white)" img="mercari">Mercari</link-box>
    <link-box href="https://www.taobao.com/" bg-color="var(--white)" img="taobao">淘宝</link-box>
  </div>
  <div class="linktext">エンターテイメント</div>
  <div class="links">
    <link-box href="https://scratch.mit.edu/" bg-color="#55ACEE" img="scratch">Scratch</link-box>
    <link-box href="https://poki.com/" bg-color="#A2FCE7" img="poki">poki</link-box>
    <link-box href="https://snake.io/" bg-color="var(--white)" img="snakeio">Snake.io</link-box>
    <link-box href="https://www.pacman.com/" bg-color="black" img="pacman">PACMAN</link-box>
    <link-box href="https://www.instagram.com/" bg-color="linear-gradient(135deg, #427eff 0%, #f13f79 70%) no-repeat" img="instagram">Instagram</link-box>
    <link-box href="https://thinking-grp.github.io/sns/" bg-color="var(--white)" img="thinking">thinking SNS</link-box>
    <link-box href="https://www.netflix.com/" bg-color="black" img="netflix">Netflix</link-box>
    <link-box href="https://www.weverse.io/" bg-color="#6AE2C2" img="weverse">Weverse</link-box>
    <link-box href="https://www.primevideo.com/" bg-color="#3171F6" img="primevideo">Prime Video</link-box>
    <link-box href="https://www.spotify.com/" bg-color="var(--white)" img="spotify">Spotify</link-box>
  </div>
  <div class="linktext">広告</div>
      <div class="ad">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6151036058675874"
  crossorigin="anonymous"></script>
  <ins class="adsbygoogle"
    style="display:block"
    data-ad-format="autorelaxed"
       data-full-width-responsive="false"
    data-ad-client="ca-pub-6151036058675874"
    data-ad-slot="9559715307"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
        </div>
</div>

</div>
  </div>
<script>
  document.getElementById('js-ver').textContent = 'JavaScriptバージョン:6-winUi';
document.addEventListener('DOMContentLoaded', function () {
  const form = document.getElementById('searchForm');
  const searchInput = document.getElementById('searchInput');
  const historyDiv = document.getElementById('history');
  const searchButton = document.querySelector('.searchbtn');

  form.addEventListener('submit', handleSearch);
  searchButton.addEventListener('click', handleSearch);
  
  function handleSearch(event) {
    event.preventDefault();
    const query = searchInput.value.trim();
    if (!query) return;

    let engine = document.querySelector('input[name="engine"]:checked').value;
    if (form.classList.contains('ai')) {
      engine = 'https://search3958.github.io/aisearch/';
    }

    const url = `${engine}?q=${encodeURIComponent(query)}`;
    saveSearchHistory(query, url, () => {
      window.location.href = url;
    });
  }

  function saveSearchHistory(query, url, callback) {
    let history = JSON.parse(localStorage.getItem('searchHistory')) || [];
    history.unshift({ query, url });
    if (history.length > 5) history = history.slice(0, 5);
    
    localStorage.setItem('searchHistory', JSON.stringify(history));
    displayHistory();
    callback(); // 保存後にコールバックでページ遷移
  }

  function displayHistory() {
    const history = JSON.parse(localStorage.getItem('searchHistory')) || [];
    historyDiv.innerHTML = '';

    if (history.length === 0) {
      historyDiv.style.display = 'none';
      return;
    }

    historyDiv.style.display = 'block';
    const clearButton = document.createElement('button');
    clearButton.classList.add('clear-button', 'shadow');
    clearButton.id = 'clearHistory';
    clearButton.innerHTML = '<span class="material-symbols-rounded deletehistory">delete_history</span>';
    historyDiv.appendChild(clearButton);

    history.forEach(item => {
      const link = document.createElement('a');
      link.href = item.url;
      link.classList.add('shadow');
      link.textContent = item.query;
      link.target = '_blank';
      historyDiv.appendChild(link);
    });

    clearButton.addEventListener('click', function () {
      localStorage.removeItem('searchHistory');
      displayHistory();
    });
  }

  displayHistory();

  window.addEventListener('scroll', function () {
    const fullScreenEl = document.getElementById('bg');
    const fullShr = document.getElementById('shortcuts');
    
    if (window.scrollY > 0) {
      fullScreenEl.classList.add('active');
      fullShr.classList.add('active');
    } else {
      fullScreenEl.classList.remove('active');
      fullShr.classList.remove('active');
    }
  });

  // AI検索エンジンへの変更を監視
  const observer = new MutationObserver(() => {
    let selectedEngine = document.querySelector('input[name="engine"]:checked').value;
    let searchInputValue = searchInput.value.trim();

    if (form.classList.contains('ai')) {
      searchButton.removeEventListener('click', handleSearch);
      searchButton.addEventListener('click', function (event) {
        event.preventDefault();
        const aiUrl = `https://search3958.github.io/aisearch/?q=${encodeURIComponent(searchInputValue)}`;
        saveSearchHistory(searchInputValue, aiUrl, () => {
          window.location.href = aiUrl;
        });
      });
    } else {
      searchButton.removeEventListener('click', handleSearch);
      searchButton.addEventListener('click', handleSearch);
    }
  });

  observer.observe(form, { attributes: true, attributeFilter: ['class'] });
});


function updateClock() {
  var now = new Date();
  var hours = now.getHours();
  var minutes = now.getMinutes();
  var ampm = hours >= 12 ? 'PM' : 'AM';
  hours = hours % 12;
  hours = hours ? hours : 12;
  minutes = minutes < 10 ? '0' + minutes : minutes;
  var timeString = hours + ':' + minutes + ' ' + ampm;
  document.getElementById('clock').innerText = timeString
};
setInterval(updateClock, 1000);

class LinkBox extends HTMLElement {
  constructor() {
    super();
    const href = this.getAttribute('href') || '#';
    const bgColor = this.getAttribute('bg-color') || 'white';
    const imgBase = this.getAttribute('img') || '';
    const content = this.textContent;
    this.innerHTML = `<a href="${href}"><div class="box"><div class="container" style="background-color:${bgColor}"><img src="" id="img1"><img src="" id="img2"><img src="" id="img3"></div>${content}</div></a>`;
    const container = this.querySelector('.container');
    container.addEventListener('mousemove', (event) => {
      const rect = container.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      const x = ((event.clientX - centerX) / (rect.width / 2)) * 15;
      const y = ((event.clientY - centerY) / (rect.height / 2)) * 15;
      container.style.setProperty('--x', `${x}deg`);
      container.style.setProperty('--y', `${y}deg`);
      container.style.setProperty('--x1', `${x * 0.5}px`);
      container.style.setProperty('--y1', `${y * 0.5}px`);
      container.style.setProperty('--x2', `${x * 0.65}px`);
      container.style.setProperty('--y2', `${y * 0.65}px`);
      container.style.setProperty('--x3', `${x * 0.8}px`);
      container.style.setProperty('--y3', `${y * 0.8}px`)
    });
    container.addEventListener('mouseleave', () => {
      container.style.setProperty('--x', '0deg');
      container.style.setProperty('--y', '0deg');
      container.style.setProperty('--x1', '0px');
      container.style.setProperty('--y1', '0px');
      container.style.setProperty('--x2', '0px');
      container.style.setProperty('--y2', '0px');
      container.style.setProperty('--x3', '0px');
      container.style.setProperty('--y3', '0px')
    })
  }
};
customElements.define('link-box', LinkBox);
class ImageLoader {
  constructor() {
    this.imageCache = new Map();
    this.zipCache = new Map()
  };
  async loadZipFile(mode) {
    if (this.zipCache.has(mode)) {
      return this.zipCache.get(mode)
    };
    const zipUrl = `https://search3958.github.io/newtab/lsr/${mode}.zip`;
    try {
      const response = await fetch(zipUrl);
      if (!response.ok) throw new Error('ZIP download failed');
      const arrayBuffer = await response.arrayBuffer();
      const zip = await new JSZip().loadAsync(arrayBuffer);
      const files = {};
      for (const [filename, file] of Object.entries(zip.files)) {
        if (!file.dir) {
          const blob = await file.async('blob');
          const dataUrl = await this.blobToDataUrl(blob);
          files[filename] = dataUrl
        }
      };
      this.zipCache.set(mode, files);
      return files
    } catch (e) {
      console.error('Error loading ZIP:', e);
      throw e
    }
  };
  async blobToDataUrl(blob) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onloadend = () => resolve(reader.result);
      reader.onerror = reject;
      reader.readAsDataURL(blob)
    })
  };
  async getImage(mode, imgBase, index) {
    const cacheKey = `${mode}_${imgBase}${index}`;
    if (this.imageCache.has(cacheKey)) {
      return this.imageCache.get(cacheKey)
    };
    try {
      const zipContents = await this.loadZipFile(mode);
      const expectedFileName = `${imgBase}${index}.webp`;
      const key = Object.keys(zipContents).find(fileName => fileName.endsWith(expectedFileName));
      if (key) {
        const imageData = zipContents[key];
        this.imageCache.set(cacheKey, imageData);
        return imageData
      };
      throw new Error('Image not found in ZIP')
    } catch (e) {
      console.error('Error getting image:', e);
      throw e
    }
  }
};
const imageLoader = new ImageLoader();
const colorModeCheckbox = document.getElementById('colorMode');
const hueRotationSlider = document.getElementById('hueRotation');
const hueValue = document.getElementById('hueValue');
async function updateAppearance() {
  const containers = document.querySelectorAll('link-box .container');
  const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
  let mode;
  if (colorModeCheckbox.checked) {
    mode = 'color';
    containers.forEach(container => {
      container.style.background = 'linear-gradient(#202020, #111'
    })
  } else {
    if (isDarkMode) {
      mode = 'dark';
      containers.forEach(container => {
        container.style.background = 'linear-gradient(#222a, #111a)'
      })
    } else {
      mode = 'light';
      containers.forEach(container => {
        const parentLinkBox = container.closest('link-box');
        const bgColor = parentLinkBox ? parentLinkBox.getAttribute('bg-color') : 'var(--white)';
        container.style.background = bgColor
      })
    }
  };
  await updateImageSources(mode);
  const hueRotation = colorModeCheckbox.checked ? hueRotationSlider.value : 0;
  updateHueRotation(hueRotation);
  hueValue.textContent = hueRotation
};
async function updateImageSources(mode) {
  const linkBoxes = document.querySelectorAll('link-box');
  for (const linkBox of linkBoxes) {
    const imgBase = linkBox.getAttribute('img');
    const images = linkBox.querySelectorAll('img');
    for (let i = 0; i < images.length; i++) {
      const img = images[i];
      try {
        const dataUrl = await imageLoader.getImage(mode, imgBase, i + 1);
        img.src = dataUrl;
        img.classList.remove('hidden')
      } catch (e) {
        if (mode === 'dark') {
          try {
            const dataUrl = await imageLoader.getImage('light', imgBase, i + 1);
            img.src = dataUrl;
            img.classList.remove('hidden')
          } catch (e2) {
            img.classList.add('hidden')
          }
        } else {
          img.classList.add('hidden')
        }
      }
    }
  }
};

function updateHueRotation(hueVal) {
  const images = document.querySelectorAll('link-box .container img');
  images.forEach(img => {
    img.style.filter = `hue-rotate(${hueVal}deg)`
  })
};

function loadSettings() {
  const colorMode = localStorage.getItem('colorMode');
  const hueRotation = localStorage.getItem('hueRotation');
  if (colorMode === 'true') {
    colorModeCheckbox.checked = !0
  } else {
    colorModeCheckbox.checked = !1
  };
  if (hueRotation) {
    hueRotationSlider.value = hueRotation
  }
};

function saveSettings() {
  localStorage.setItem('colorMode', colorModeCheckbox.checked);
  localStorage.setItem('hueRotation', hueRotationSlider.value)
};
loadSettings();
colorModeCheckbox.addEventListener('change', () => {
  updateAppearance();
  saveSettings()
});
hueRotationSlider.addEventListener('input', () => {
  updateAppearance();
  saveSettings()
});
window.matchMedia('(prefers-color-scheme: dark)').addListener(updateAppearance);
updateAppearance();
const defaultImageUrl = "https://search3958.github.io/newtab/bgimg/bg1.webp";
window.onload = function() {
  const storedImageUrl = localStorage.getItem('backgroundImageUrl');
  if (storedImageUrl) {
    document.body.style.backgroundImage = `url(${storedImageUrl})`;
    document.getElementById('imageUrl').value = storedImageUrl
  } else {
    document.body.style.backgroundImage = `url(${defaultImageUrl})`;
    document.getElementById('imageUrl').value = defaultImageUrl
  }
};

function updateBackground() {
  const imageUrl = document.getElementById('imageUrl').value;
  document.body.style.backgroundImage = `url(${imageUrl})`;
  localStorage.setItem('backgroundImageUrl', imageUrl)
};

function resetBackground() {
  document.body.style.backgroundImage = `url(${defaultImageUrl})`;
  document.getElementById('imageUrl').value = defaultImageUrl;
  localStorage.removeItem('backgroundImageUrl')
};
navigator.getBattery().then(function(battery) {
  if (battery.level <= 0.2) {
    const batteryStatusElement = document.getElementById('batteryStatus');
    batteryStatusElement.innerHTML = '<span class="material-symbols-rounded batteryicon">battery_1_bar</span>残量低下 ' + Math.round(battery.level * 100) + '%';
    batteryStatusElement.style.display = 'block'
  }
})

document.querySelector('.aibtn').addEventListener('click', function() {
            const image = document.querySelector('.aibg');
            const bar = document.querySelector('.aibar');
  const edge = document.querySelector('.edge');
  const history = document.querySelector('.history');
  const engine = document.querySelector('.engine');
  const searchtext = document.querySelector('.searchtext');
  const box = document.querySelector('.search');
            const isActive = image.classList.contains('active');
  const iconElement = document.querySelector(".material-symbols-rounded.searchicon");
            
            if (isActive) {
                this.classList.remove('active');
                image.classList.remove('active');
              edge.classList.remove('active');
                bar.classList.remove('active');
              history.classList.remove('ai');
              engine.classList.remove('ai');
              searchtext.classList.remove('ai');
              box.classList.remove('ai');
              document.querySelector('.searchtext').setAttribute('placeholder', 'Search');
              iconElement.textContent = "search";

            } else {
                this.classList.add('active');
                image.classList.add('active');
              edge.classList.add('active');
                bar.classList.add('active');
              history.classList.add('ai');
              engine.classList.add('ai');
              searchtext.classList.add('ai');
              box.classList.add('ai');
              document.querySelector('.searchtext').setAttribute('placeholder', 'AIは不正確な情報を表示することがあります');
              iconElement.textContent = "arrow_forward";
            }
        });



let isVisible = false; // 要素が表示されているかどうかの状態

// ボタンがクリックされたとき
document.getElementById('showBtn').addEventListener('click', function() {
    const container = document.querySelector('.settingcontainer');
    const items = document.querySelectorAll('.item');
    let blurBackground = document.querySelector('.blur-background');

    // blurBackgroundが存在しない場合は新しく作成
    if (!blurBackground) {
        blurBackground = createBlurBackground();
        document.body.appendChild(blurBackground); // bodyに追加
    }

    // 背景がクリックされた場合の処理を追加
    blurBackground.addEventListener('click', closeSettings);

    if (isVisible) {
        // 非表示アニメーション
        container.style.opacity = 0;
        container.style.pointerEvents = 'none';
        blurBackground.style.opacity = 0;

        // すべてのアイテムを一緒に上に移動させる
        items.forEach((item) => {
            setTimeout(() => {
                item.style.transform = 'translateY(-100px)';
                item.style.opacity = 0;
            }, 1); // 少し遅延を入れて全てのアイテムを一緒に非表示
        });

        // 非表示が完了したらブラー背景を削除
        setTimeout(() => {
            if (blurBackground) {
                blurBackground.remove();
            }
        }, 300); // アニメーション後に削除
    } else {
        // 表示アニメーション
        container.style.opacity = 1;
        container.style.pointerEvents = 'auto';
        blurBackground.style.opacity = 1;

        items.forEach((item, index) => {
            setTimeout(() => {
                item.style.visibility = 'visible';
                item.style.transform = 'translateY(0)';
                item.style.opacity = 1;
            }, index * 40); // 各アイテムの表示に遅延を追加
        });
    }

    // 状態を反転
    isVisible = !isVisible;
});

// 設定を閉じる関数
function closeSettings() {
    const container = document.querySelector('.settingcontainer');
    const items = document.querySelectorAll('.item');
    const blurBackground = document.querySelector('.blur-background');

    if (isVisible) {
        // 非表示アニメーション
        container.style.opacity = 0;
        container.style.pointerEvents = 'none';
        blurBackground.style.opacity = 0;

        // すべてのアイテムを一緒に上に移動させる
        items.forEach((item) => {
            setTimeout(() => {
                item.style.transform = 'translateY(-100px)';
                item.style.opacity = 0;
            }, 1); // 少し遅延を入れて全てのアイテムを一緒に非表示
        });

        // 非表示が完了したらブラー背景を削除
        setTimeout(() => {
            if (blurBackground) {
                blurBackground.remove();
            }
        }, 300); // アニメーション後に削除

        // 状態を反転
        isVisible = false;
    }
}

// blur-backgroundの作成関数（必要なら定義）
function createBlurBackground() {
    const blurBackground = document.createElement('div');
    blurBackground.classList.add('blur-background');
    blurBackground.style.position = 'fixed';
    blurBackground.style.top = 0;
    blurBackground.style.left = 0;
    blurBackground.style.transition = 'opacity 0.3s ease'; // アニメーション用のトランジション
    blurBackground.style.opacity = 0;

    return blurBackground;
}


function changeText1() {
            document.getElementById("imageUrl").value = "https://search3958.github.io/newtab/bgimg/bg1.webp";
        }
        
        function changeText2() {
            document.getElementById("imageUrl").value = "https://search3958.github.io/newtab/bgimg/bg3.webp";
        }

document.getElementById('searchForm').addEventListener('submit', function(event) {
    event.preventDefault(); // フォーム送信のデフォルト動作をキャンセル
    
    let selectedEngine = document.querySelector('input[name="engine"]:checked').value;
    let searchInput = document.getElementById('searchInput').value;
    
    // .aiが#searchFormに追加されているかどうかを確認
    if (document.getElementById('searchForm').classList.contains('ai')) {
      // .aiが追加されていれば、AI検索エンジンに変更
      window.location.href = `https://search3958.github.io/aisearch/?q=${encodeURIComponent(searchInput)}`;
    } else {
      // それ以外の場合は、選択された検索エンジンを使う
      window.location.href = `${selectedEngine}?q=${encodeURIComponent(searchInput)}`;
    }
  });

  // .aiクラスが追加されているかどうかを監視し、変更時に対応
  const observer = new MutationObserver(() => {
    let selectedEngine = document.querySelector('input[name="engine"]:checked').value;
    let searchInput = document.getElementById('searchInput').value;

    if (document.getElementById('searchForm').classList.contains('ai')) {
      // .aiが追加されていれば、AI検索エンジンに変更
      document.querySelector('.searchbtn').addEventListener('click', function(event) {
        event.preventDefault();
        window.location.href = `https://search3958.github.io/aisearch/?q=${encodeURIComponent(searchInput)}`;
      });
    } else {
      // それ以外の場合は、選択された検索エンジンに戻す
      document.querySelector('.searchbtn').addEventListener('click', function(event) {
        event.preventDefault();
        window.location.href = `${selectedEngine}?q=${encodeURIComponent(searchInput)}`;
      });
    }
  });

  observer.observe(document.getElementById('searchForm'), {
    attributes: true
  });
function updateBatteryStatus() {
  navigator.getBattery().then(function (battery) {
    var batteryLevel = battery.level * 100;
    var batteryFill = document.getElementById('battery-fill');
    var batteryText = document.getElementById('battery-text');

    batteryFill.style.height = batteryLevel + '%';
    batteryText.textContent = Math.round(batteryLevel) + '%';
  });
}

window.addEventListener('load', updateBatteryStatus);

const backgrounds = {
  '不明': 'linear-gradient(180deg, #58A6FF85 0%, #486DFF85 100%)',
  '晴': 'linear-gradient(180deg, #58A6FF85 0%, #486DFF85 100%)',
  '曇り': 'linear-gradient(180deg, rgba(174,219,241,0.5) 0%, rgba(94,133,162,0.5) 100%)',
  '夜': 'linear-gradient(180deg, rgba(62,56,79,0.5) 0%, rgba(28,25,34,0.5) 100%)'
};

const weatherBox = document.getElementById('weatherBox');
const tempElem = document.querySelector('.temperature');
const weatherElem = document.querySelector('.weather');
const locationElem = document.querySelector('.location');

function isNight() {
  const hour = new Date().getHours();
  return (hour < 6 || hour >= 18);
}

function mapWeatherCodeToDescription(code) {
  if (code === 0) return '晴';
  if (code >= 1 && code <= 3) return '曇り';
  return '不明';
}

fetch('https://ipinfo.io/json?token=1725a58ec90e86')
  .then(response => response.json())
  .then(data => {
    const [lat, lon] = data.loc.split(',');
    const city = data.city || '';
    const region = data.region || '';
    const country = data.country || '';
    locationElem.textContent = `${city} ${region} ${country}`;

    const weatherUrl = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&timezone=Asia%2FTokyo`;
    fetch(weatherUrl)
      .then(response => response.json())
      .then(weatherData => {
        const current = weatherData.current_weather;
        const temperature = current.temperature !== undefined ? current.temperature : '--';
        let weatherDesc = mapWeatherCodeToDescription(current.weathercode);
        tempElem.textContent = temperature + '°C';
        weatherElem.textContent = weatherDesc;

        let bgKey = isNight() ? '夜' : weatherDesc;
        if (!backgrounds[bgKey]) bgKey = '不明';
        weatherBox.style.background = backgrounds[bgKey];
      })
      .catch(error => {
        console.error('天気情報取得エラー:', error);
        weatherElem.textContent = '天気情報取得失敗';
        weatherBox.style.background = backgrounds['不明'];
      });
  })
  .catch(error => {
    console.error('位置情報取得エラー:', error);
    locationElem.textContent = '位置情報取得失敗';
  });

// 日付と曜日だけ表示（アナログ時計の針は削除）
function updateDisplay() {
  const now = new Date();
  const days = ["日", "月", "火", "水", "木", "金", "土"];
  document.getElementById('day-of-week').textContent = days[now.getDay()] + "曜日";
  document.getElementById('month-day').textContent = (now.getMonth() + 1) + "月" + now.getDate() + "日";
}

setInterval(updateDisplay, 1000);
updateDisplay();

// ストップウォッチ機能
let isRunning = false;
let time = 0;
let timerInterval;

const playPauseBtn = document.getElementById('playPauseBtn');
const resetBtn = document.getElementById('resetBtn');
const timeDisplay = document.getElementById('timeDisplay');

playPauseBtn.addEventListener('click', () => {
  if (isRunning) {
    clearInterval(timerInterval);
    playPauseBtn.innerHTML = '<span class="material-symbols-rounded stopwatchicon">play_arrow</span>';
  } else {
    timerInterval = setInterval(() => {
      time++;
      updateTimeDisplay();
    }, 1000);
    playPauseBtn.innerHTML = '<span class="material-symbols-rounded stopwatchicon">pause</span>';
  }
  isRunning = !isRunning;
});

resetBtn.addEventListener('click', () => {
  clearInterval(timerInterval);
  time = 0;
  updateTimeDisplay();
  playPauseBtn.innerHTML = '<span class="material-symbols-rounded stopwatchicon">play_arrow</span>';
  isRunning = false;
});

function updateTimeDisplay() {
  const minutes = Math.floor(time / 60);
  const seconds = time % 60;
  timeDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
}

</script>
</body>
</html>
